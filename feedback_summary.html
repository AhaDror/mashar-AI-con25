<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¡×™×›×•× ××©×•×‘ ×›× ×¡ AI - ××©"×¨ 2025</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Assistant', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1e1b4b 50%, #581c87 100%);
            color: #ffffff;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 2px solid rgba(139, 92, 246, 0.3);
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 3.2rem;
            font-weight: 900;
            background: linear-gradient(135deg, #fbbf24, #f59e0b, #dc2626);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.6);
            animation: titlePulse 3s ease-in-out infinite alternate;
        }

        @keyframes titlePulse {
            0% {
                filter: brightness(1);
            }
            100% {
                filter: brightness(1.3);
            }
        }

        .subtitle {
            font-size: 1.2rem;
            color: #e2e8f0;
            margin-bottom: 20px;
        }

        .back-btn {
            display: inline-block;
            background: linear-gradient(135deg, #8b5cf6, #10b981);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #e2e8f0;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(139, 92, 246, 0.3);
            border-top: 4px solid #8b5cf6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(245, 158, 11, 0.15), rgba(220, 38, 38, 0.1));
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(251, 191, 36, 0.2);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(251, 191, 36, 0.3);
            border-color: rgba(251, 191, 36, 0.5);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #fbbf24, #f59e0b, #dc2626, #fbbf24);
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        .stat-number {
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #fbbf24, #f59e0b, #dc2626);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
            animation: numberGlow 2s ease-in-out infinite alternate;
        }

        @keyframes numberGlow {
            0% {
                filter: brightness(1);
                transform: scale(1);
            }
            100% {
                filter: brightness(1.2);
                transform: scale(1.05);
            }
        }

        .stat-label {
            font-size: 1.1rem;
            color: #ffffff;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .section {
            margin-bottom: 50px;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, #8b5cf6, #10b981);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: #ffffff;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 200px;
            font-weight: 600;
            color: #e2e8f0;
        }

        .bar-container {
            flex: 1;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #8b5cf6, #10b981);
            border-radius: 15px;
            transition: width 1s ease;
            position: relative;
            width: 0%;
        }

        .bar-value {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: 700;
            color: white;
            font-size: 0.9rem;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .insight-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(16, 185, 129, 0.08));
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            position: relative;
        }

        .insight-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #8b5cf6, #10b981, #06b6d4);
        }

        .insight-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #ffffff;
        }

        .insight-content {
            color: #e2e8f0;
            line-height: 1.6;
        }

        .quotes-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .quote {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(16, 185, 129, 0.1));
            border-left: 4px solid #10b981;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 0 10px 10px 0;
            font-style: italic;
            position: relative;
        }

        .quote::before {
            content: '"';
            font-size: 3rem;
            color: #8b5cf6;
            position: absolute;
            top: -10px;
            right: 15px;
            opacity: 0.5;
        }

        .quote-text {
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .quote-author {
            color: #10b981;
            font-weight: 600;
            font-style: normal;
        }

        .recommendations {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(6, 182, 212, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 15px;
            padding: 30px;
        }

        .recommendation-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .recommendation-icon {
            background: linear-gradient(135deg, #10b981, #06b6d4);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .recommendation-text {
            color: #e2e8f0;
            flex: 1;
        }

        .pie-chart {
            width: 300px;
            height: 300px;
            margin: 0 auto;
            border-radius: 50%;
            position: relative;
        }

        .pie-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .legend-text {
            color: #e2e8f0;
            font-weight: 600;
        }

        .data-note {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #e2e8f0;
            font-style: italic;
        }

        .accordion-container {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 20px 25px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(16, 185, 129, 0.1));
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .accordion-header:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(16, 185, 129, 0.15));
        }

        .accordion-header h3 {
            margin: 0;
            font-size: 1.2rem;
            color: #ffffff;
        }

        .accordion-arrow {
            font-size: 1.2rem;
            color: #8b5cf6;
            transition: transform 0.3s ease;
        }

        .accordion-content {
            display: none;
            padding: 25px;
        }

        .feedback-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .feedback-category {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
        }

        .feedback-category h4 {
            font-size: 1.1rem;
            color: #10b981;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(16, 185, 129, 0.3);
            padding-bottom: 8px;
        }

        .feedback-item {
            background: rgba(255, 255, 255, 0.05);
            border-right: 3px solid #8b5cf6;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .feedback-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(-3px);
        }

        .feedback-text {
            color: #e2e8f0;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .feedback-author {
            color: #10b981;
            font-weight: 600;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .bar-label {
                min-width: 150px;
                font-size: 0.9rem;
            }

            .pie-chart {
                width: 250px;
                height: 250px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="main-title">ğŸ“Š ×¡×™×›×•× ××©×•×‘ ×›× ×¡ AI</h1>
            <p class="subtitle">××©"×¨ ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ â€¢ 3 ×™×•×œ×™ 2025</p>
            <a href="index.html" class="back-btn">ğŸ  ×—×–×¨×” ×œ×“×£ ×”×›× ×¡</a>
        </div>

        <!-- Loading State -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <h3>×˜×•×¢×Ÿ × ×ª×•× ×™ ××©×•×‘...</h3>
            <p>×§×•×¨× ××§×•×‘×¥ CSV ×•××—×©×‘ ×¡×˜×˜×™×¡×˜×™×§×•×ª</p>
        </div>

        <!-- Main Content (hidden initially) -->
        <div id="main-content" style="display: none;">
            <!-- Data Source Note -->
            <div class="data-note">
                ğŸ“Š ×”× ×ª×•× ×™× ××ª×¢×“×›× ×™× ××•×˜×•××˜×™×ª ××§×•×‘×¥ ×”××©×•×‘ â€¢ ×¢×“×›×•×Ÿ ××—×¨×•×Ÿ: <span id="last-updated"></span>
            </div>

            <!-- Key Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">62</div>
                    <div class="stat-label">× ×¨×©××• ×œ×›× ×¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">55</div>
                    <div class="stat-label">×”×©×ª×ª×¤×• ×‘×¡×“× ××•×ª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="feedback-responses">-</div>
                    <div class="stat-label">×¢× ×• ×¢×œ ×©××œ×•×Ÿ ××©×•×‘</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="overall-satisfaction">-</div>
                    <div class="stat-label">×¦×™×•×Ÿ ×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ ×›×œ×œ×™×ª</div>
                </div>
            </div>

            <!-- Workshop Ratings -->
            <div class="section">
                <h2 class="section-title">ğŸ¯ ×¦×™×•× ×™× ×œ×¡×“× ××•×ª</h2>
                <div class="chart-container">
                    <h3 class="chart-title">×××•×¦×¢ ×¦×™×•× ×™× ×œ×›×œ ×¡×“× ×” (1-5)</h3>
                    <div class="bar-chart" id="workshop-chart">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Lecture Ratings -->
            <div class="section">
                <h2 class="section-title">ğŸ¤ ×¦×™×•× ×™× ×œ×”×¨×¦××•×ª</h2>
                <div class="chart-container">
                    <h3 class="chart-title">×××•×¦×¢ ×¦×™×•× ×™× ×œ×”×¨×¦××•×ª (1-5)</h3>
                    <div class="bar-chart" id="lecture-chart">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Geographic Distribution -->
            <div class="section">
                <h2 class="section-title">ğŸ—ºï¸ ×”×ª×¤×œ×’×•×ª ×’×™××•×’×¨×¤×™×ª ×©×œ ×”××©×™×‘×™×</h2>
                <div class="chart-container">
                    <h3 class="chart-title">×”×ª×¤×œ×’×•×ª ×œ×¤×™ ××¨×›×–×™ ×¢×‘×•×“×”</h3>
                    <div class="pie-chart" id="geo-chart"></div>
                    <div class="pie-legend" id="geo-legend">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Experience Level Distribution -->
            <div class="section">
                <h2 class="section-title">ğŸ“ˆ ×¨××•×ª × ×™×¡×™×•×Ÿ ×©×œ ×”××©×ª×ª×¤×™×</h2>
                <div class="chart-container">
                    <h3 class="chart-title">×”×ª×¤×œ×’×•×ª ×¨××•×ª × ×™×¡×™×•×Ÿ ×¢× AI ×œ×¤× ×™ ×”×›× ×¡</h3>
                    <div class="bar-chart" id="experience-chart">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Key Insights -->
            <div class="section">
                <h2 class="section-title">ğŸ’¡ ×ª×•×‘× ×•×ª ×¢×™×§×¨×™×•×ª</h2>
                <div class="insights-grid" id="insights-grid">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <!-- Participant Quotes -->
            <div class="section">
                <h2 class="section-title">ğŸ’¬ ×¦×™×˜×•×˜×™× ××”××©×ª×ª×¤×™×</h2>
                <div class="quotes-section" id="quotes-section">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <!-- Recommendations -->
            <div class="section">
                <h2 class="section-title">ğŸš€ ×”××œ×¦×•×ª ×œ×¢×ª×™×“</h2>
                <div class="recommendations">
                    <div class="recommendation-item">
                        <div class="recommendation-icon">1</div>
                        <div class="recommendation-text">
                            <strong>×™×•×ª×¨ ×–××Ÿ ×œ×¡×“× ××•×ª:</strong> ×œ×”×§×¦×•×ª 90-120 ×“×§×•×ª ×œ×›×œ ×¡×“× ×” ×‘××§×•× 75 ×“×§×•×ª, ×›×“×™ ×œ××¤×©×¨
                            ×ª×¨×’×•×œ ××¢××™×§ ×™×•×ª×¨.
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">2</div>
                        <div class="recommendation-text">
                            <strong>×“×•×’×××•×ª ××•×›× ×•×ª ××¨××©:</strong> ×œ×”×›×™×Ÿ ×ª×‘× ×™×•×ª ×•×¤×¨×•××¤×˜×™× ××•×›× ×™× ×›× ×§×•×“×ª ×”×ª×—×œ×” ×œ××©×ª×ª×¤×™×
                            ×‘×¨××•×ª ×©×•× ×•×ª.
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">3</div>
                        <div class="recommendation-text">
                            <strong>×× ×•×™ ××¨×’×•× ×™:</strong> ×œ×©×§×•×œ ×¨×›×™×©×ª ×× ×•×™×™× ×œ×›×œ×™ AI ××ª×§×“××™× ×¢×‘×•×¨ ×”××•×¨×™×, ×›×¤×™ ×©×”×•×¦×¢
                            ×‘××©×•×‘.
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">4</div>
                        <div class="recommendation-text">
                            <strong>××¢×§×‘ ×•×”××©×›×™×•×ª:</strong> ×œ××¨×’×Ÿ ××¤×’×©×™ ×”××©×š ××• ×§×‘×•×¦×•×ª ×¢×‘×•×“×” ×œ×©×™×ª×•×£ × ×™×¡×™×•×Ÿ ×•×˜×™×¤×•×— ×”×©×™××•×©
                            ×‘-AI.
                        </div>
                    </div>
                    <div class="recommendation-item">
                        <div class="recommendation-icon">5</div>
                        <div class="recommendation-text">
                            <strong>×”×ª××—×•×ª ×œ×¤×™ × ×•×©××™×:</strong> ×‘×›× ×¡ ×”×‘× ×œ×©×§×•×œ ×¡×“× ××•×ª ××ª××—×•×ª ×™×•×ª×¨ ×œ×¤×™ ××§×¦×•×¢×•×ª ××• ×¨××•×ª
                            × ×™×¡×™×•×Ÿ.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="header"
                style="border-top: 2px solid rgba(139, 92, 246, 0.3); border-bottom: none; margin-top: 40px; margin-bottom: 0;">
                <h2 style="font-size: 1.5rem; margin-bottom: 20px;">ğŸ™ ×ª×•×“×” ×œ××©×ª×ª×¤×™×</h2>
                <p style="margin-bottom: 20px;">×”××©×•×‘ ×©×œ×›× ×—×©×•×‘ ×œ× ×• ×•×™×¢×–×•×¨ ×œ×©×¤×¨ ×›× ×¡×™× ×¢×ª×™×“×™×™×</p>
                <a href="index.html" class="back-btn">ğŸ  ×—×–×¨×” ×œ×“×£ ×”×›× ×¡</a>
            </div>
        </div>
    </div>

    <script>
        // CSV parsing utility
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = parseCSVLine(lines[0]);

            // Debug: Log headers
            console.log('CSV Headers:', headers);

            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = parseCSVLine(lines[i]);
                    if (values.length >= headers.length) {
                        const row = {};
                        headers.forEach((header, index) => {
                            row[header] = values[index] ? values[index].trim() : '';
                        });
                        data.push(row);
                    }
                }
            }

            // Debug: Log first few rows
            console.log('First 3 data rows:', data.slice(0, 3));

            return data;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            return result;
        }

        // Calculate statistics from data
        function calculateStats(data) {
            const stats = {
                totalResponses: data.length,
                locations: {},
                experienceLevel: {},
                workshopRatings: {},
                lectureRatings: {},
                satisfactionScores: [],
                implementationReadiness: [],
                quotes: []
            };

            data.forEach(row => {
                // Location distribution
                const workCenter = row['×× ×™ ×¢×•×‘×“.×ª ×‘××¨×›×–:'];
                if (workCenter && workCenter.trim() !== '') {
                    const cleanWorkCenter = workCenter.trim();
                    stats.locations[cleanWorkCenter] = (stats.locations[cleanWorkCenter] || 0) + 1;
                }

                // Experience level
                const experience = row['×¨××ª ×”× ×™×¡×™×•×Ÿ ×©×œ×›× ×¢× AI ×œ×¤× ×™ ×”×›× ×¡:'];
                if (experience && experience.trim() !== '') {
                    const cleanExperience = experience.trim();
                    stats.experienceLevel[cleanExperience] = (stats.experienceLevel[cleanExperience] || 0) + 1;
                }

                // Workshop ratings
                const workshopColumns = [
                    'ğŸ“Š ×¡×“× ×” 1: ××”×©××œ×” â€“ ×œ×¤×ª×¨×•×Ÿ, ××”×¤×ª×¨×•×Ÿ â€“ ×œ××—×•×•×Ÿ',
                    'âœ… ×¡×“× ×” 2: ×‘×“×™×§×ª ××˜×œ×•×ª ×¢× ×›×œ×™ AI',
                    'ğŸ“ ×¡×“× ×” 3: ×œ×©×œ×‘ AI ×‘×›×™×ª×”',
                    'ğŸ’» ×¡×“× ×” 4: ×¤×™×ª×•×— ×œ×œ× ××ª×›× ×ª×™×',
                    'ğŸ¢ ×¡×“× ×” 5: ××” ×¢×•×©×™× ×¢× AI ×‘×¢×‘×•×“×”?'
                ];

                workshopColumns.forEach(workshop => {
                    const ratingValue = row[workshop];
                    if (ratingValue && ratingValue.trim() !== '') {
                        const rating = parseFloat(ratingValue);
                        if (!isNaN(rating) && rating > 0 && rating <= 5) {
                            if (!stats.workshopRatings[workshop]) {
                                stats.workshopRatings[workshop] = [];
                            }
                            stats.workshopRatings[workshop].push(rating);
                        }
                    }
                });

                // Lecture ratings
                const lectureColumns = [
                    '×”×¨×¦××” - ×“×¨×•×¨ ××”×¨×•× ×™',
                    '×”×¨×¦××” - ×¨×•×¢×™ ×¦×–× ×”'
                ];

                lectureColumns.forEach(lecture => {
                    const ratingValue = row[lecture];
                    if (ratingValue && ratingValue.trim() !== '') {
                        const rating = parseFloat(ratingValue);
                        if (!isNaN(rating) && rating > 0 && rating <= 5) {
                            if (!stats.lectureRatings[lecture]) {
                                stats.lectureRatings[lecture] = [];
                            }
                            stats.lectureRatings[lecture].push(rating);
                        }
                    }
                });

                // Satisfaction scores
                const satisfactionValue = row['×¢×“ ×›××” ×”×›× ×¡ ×¢××“ ×‘×¦×™×¤×™×•×ª ×©×œ×›×?'];
                if (satisfactionValue && satisfactionValue.trim() !== '') {
                    const satisfaction = parseFloat(satisfactionValue);
                    if (!isNaN(satisfaction) && satisfaction > 0 && satisfaction <= 5) {
                        stats.satisfactionScores.push(satisfaction);
                    }
                }

                // Implementation readiness
                const readinessValue = row['×‘××™×–×” ××™×“×” ×ª×¨×’×™×©×• ××•×›× ×™× ×œ×™×™×©× ××ª ××” ×©×œ××“×ª×?'];
                if (readinessValue && readinessValue.trim() !== '') {
                    const readiness = parseFloat(readinessValue);
                    if (!isNaN(readiness) && readiness > 0 && readiness <= 5) {
                        stats.implementationReadiness.push(readiness);
                    }
                }

                // Collect meaningful quotes
                const additionalComments = row['×”×¢×¨×•×ª × ×•×¡×¤×•×ª:'];
                const name = row['×©× ××œ×'];
                const authorLocation = row['×× ×™ ×¢×•×‘×“.×ª ×‘××¨×›×–:'];

                if (additionalComments && additionalComments.length > 50 && name) {
                    stats.quotes.push({
                        text: additionalComments,
                        author: `${name}, ${authorLocation}`
                    });
                }
            });

            // Debug: Log stats for verification
            console.log('Stats Summary:', {
                totalResponses: stats.totalResponses,
                locations: stats.locations,
                experienceLevel: stats.experienceLevel,
                workshopRatings: Object.keys(stats.workshopRatings).map(w => ({
                    workshop: w,
                    count: stats.workshopRatings[w].length,
                    average: (stats.workshopRatings[w].reduce((a, b) => a + b, 0) / stats.workshopRatings[w].length).toFixed(2)
                })),
                lectureRatings: Object.keys(stats.lectureRatings).map(l => ({
                    lecture: l,
                    count: stats.lectureRatings[l].length,
                    average: (stats.lectureRatings[l].reduce((a, b) => a + b, 0) / stats.lectureRatings[l].length).toFixed(2)
                })),
                avgSatisfaction: stats.satisfactionScores.length > 0 ? (stats.satisfactionScores.reduce((a, b) => a + b, 0) / stats.satisfactionScores.length).toFixed(2) : 'N/A',
                avgReadiness: stats.implementationReadiness.length > 0 ? (stats.implementationReadiness.reduce((a, b) => a + b, 0) / stats.implementationReadiness.length).toFixed(2) : 'N/A'
            });

            return stats;
        }

        // Render functions
        function renderKeyStats(stats) {
            // Update only dynamic statistics (62 registered and 55 workshop participants are fixed)
            document.getElementById('feedback-responses').textContent = stats.totalResponses;

            const avgSatisfaction = stats.satisfactionScores.length > 0
                ? (stats.satisfactionScores.reduce((a, b) => a + b, 0) / stats.satisfactionScores.length).toFixed(1)
                : '-';
            document.getElementById('overall-satisfaction').textContent = avgSatisfaction;
        }

        function renderWorkshopChart(stats) {
            const container = document.getElementById('workshop-chart');
            container.innerHTML = '';

            const workshopNames = {
                'ğŸ“Š ×¡×“× ×” 1: ××”×©××œ×” â€“ ×œ×¤×ª×¨×•×Ÿ, ××”×¤×ª×¨×•×Ÿ â€“ ×œ××—×•×•×Ÿ': 'ğŸ“Š ××”×©××œ×” ×œ×¤×ª×¨×•×Ÿ',
                'âœ… ×¡×“× ×” 2: ×‘×“×™×§×ª ××˜×œ×•×ª ×¢× ×›×œ×™ AI': 'âœ… ×‘×“×™×§×ª ××˜×œ×•×ª ×¢× AI',
                'ğŸ“ ×¡×“× ×” 3: ×œ×©×œ×‘ AI ×‘×›×™×ª×”': 'ğŸ“ ×œ×©×œ×‘ AI ×‘×›×™×ª×”',
                'ğŸ’» ×¡×“× ×” 4: ×¤×™×ª×•×— ×œ×œ× ××ª×›× ×ª×™×': 'ğŸ’» ×¤×™×ª×•×— ×œ×œ× ××ª×›× ×ª×™×',
                'ğŸ¢ ×¡×“× ×” 5: ××” ×¢×•×©×™× ×¢× AI ×‘×¢×‘×•×“×”?': 'ğŸ¢ ××” ×¢×•×©×™× ×¢× AI ×‘×¢×‘×•×“×”'
            };

            const sortedWorkshops = Object.entries(stats.workshopRatings)
                .map(([workshop, ratings]) => ({
                    name: workshopNames[workshop] || workshop,
                    average: ratings.reduce((a, b) => a + b, 0) / ratings.length,
                    count: ratings.length
                }))
                .sort((a, b) => b.average - a.average);

            sortedWorkshops.forEach(workshop => {
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-label">${workshop.name}</div>
                    <div class="bar-container">
                        <div class="bar-fill" data-value="${(workshop.average / 5 * 100).toFixed(0)}">
                            <div class="bar-value">${workshop.average.toFixed(1)} (${workshop.count})</div>
                        </div>
                    </div>
                `;
                container.appendChild(barItem);
            });
        }

        function renderLectureChart(stats) {
            const container = document.getElementById('lecture-chart');
            container.innerHTML = '';

            const lectureNames = {
                '×”×¨×¦××” - ×“×¨×•×¨ ××”×¨×•× ×™': '×“×¨×•×¨ ××©×” ××”×¨×•× ×™ - ×™×›×•×œ×•×ª AI ×›×™×•×',
                '×”×¨×¦××” - ×¨×•×¢×™ ×¦×–× ×”': '×“"×¨ ×¨×•×¢×™ ×¦×–× ×” - ×”×¢×ª×™×“×™× ×”×¦×¤×•×™×™×'
            };

            Object.entries(stats.lectureRatings).forEach(([lecture, ratings]) => {
                const average = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-label">${lectureNames[lecture] || lecture}</div>
                    <div class="bar-container">
                        <div class="bar-fill" data-value="${(average / 5 * 100).toFixed(0)}">
                            <div class="bar-value">${average.toFixed(1)} (${ratings.length})</div>
                        </div>
                    </div>
                `;
                container.appendChild(barItem);
            });
        }

        function renderGeographicChart(stats) {
            const colors = ['#8b5cf6', '#10b981', '#06b6d4', '#f59e0b', '#ef4444', '#84cc16', '#f97316'];
            const total = Object.values(stats.locations).reduce((a, b) => a + b, 0);

            let cumulativePercentage = 0;
            let gradientStops = [];
            const legendContainer = document.getElementById('geo-legend');
            legendContainer.innerHTML = '';

            Object.entries(stats.locations).forEach(([location, count], index) => {
                const percentage = (count / total) * 100;
                const color = colors[index % colors.length];

                gradientStops.push(`${color} ${cumulativePercentage}% ${cumulativePercentage + percentage}%`);
                cumulativePercentage += percentage;

                // Add legend item
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background: ${color};"></div>
                    <div class="legend-text">${location} (${count})</div>
                `;
                legendContainer.appendChild(legendItem);
            });

            const pieChart = document.getElementById('geo-chart');
            pieChart.style.background = `conic-gradient(${gradientStops.join(', ')})`;
        }

        function renderExperienceChart(stats) {
            const container = document.getElementById('experience-chart');
            container.innerHTML = '';

            Object.entries(stats.experienceLevel).forEach(([level, count]) => {
                const percentage = (count / stats.totalResponses) * 100;
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-label">${level}</div>
                    <div class="bar-container">
                        <div class="bar-fill" data-value="${percentage.toFixed(0)}">
                            <div class="bar-value">${count} (${percentage.toFixed(0)}%)</div>
                        </div>
                    </div>
                `;
                container.appendChild(barItem);
            });
        }

        function renderInsights(stats) {
            const container = document.getElementById('insights-grid');
            container.innerHTML = '';

            const avgImplementation = stats.implementationReadiness.length > 0
                ? (stats.implementationReadiness.reduce((a, b) => a + b, 0) / stats.implementationReadiness.length).toFixed(1)
                : 0;

            const beginnerCount = (stats.experienceLevel['××ª×—×™×œ'] || 0);
            const basicCount = (stats.experienceLevel['×‘×¡×™×¡×™'] || 0);
            const beginnerPercentage = (beginnerCount + basicCount) / stats.totalResponses * 100;

            const insights = [
                {
                    title: 'ğŸ¯ ×”×ª×××” ××•×©×œ××ª ×œ×¦×¨×›×™×',
                    content: `×”×¡×“× ××•×ª ×”×ª××™××• ×‘××“×•×™×§ ×œ×¦×¨×›×™× ×©×–×•×”×• ××¨××©: ×‘×“×™×§×ª ××‘×—× ×™×, ×™×¦×™×¨×ª ×ª×•×›×Ÿ ×—×™× ×•×›×™, ×•×¤×™×ª×•×— ×›×œ×™× ×˜×›× ×•×œ×•×’×™×™×. ×¢×œ ×¡××š ${stats.totalResponses} ××©×™×‘×™×.`
                },
                {
                    title: 'ğŸ“ˆ ×¨××ª × ×™×¡×™×•×Ÿ ××’×•×•× ×ª',
                    content: `${beginnerPercentage.toFixed(0)}% ××”××©×ª×ª×¤×™× ×”×’×™×¢×• ×¢× ×¨××ª × ×™×¡×™×•×Ÿ ×‘×¡×™×¡×™×ª ××• ××ª×—×™×œ×”, ××” ×©××“×’×™×© ××ª ×”×¦×•×¨×š ×‘×”×›×©×¨×ª ××•×¨×™× ×‘× ×•×©× AI.`
                },
                {
                    title: 'âš¡ ×“×’×© ×¢×œ ×¤×¨×§×˜×™×§×”',
                    content: `×”××©×•×‘ ×”×¢×™×§×¨×™ ×”×™×” ×‘×§×©×” ×œ×™×•×ª×¨ ×–××Ÿ ×ª×¨×’×•×œ ×•×“×•×’×××•×ª ××¢×©×™×•×ª. ×”××©×ª×ª×¤×™× ×¨×¦×• ×¤×—×•×ª ×ª×™××•×¨×™×” ×•×™×•×ª×¨ "×œ×©×™× ×™×“ ×¢×œ ×”×××ª".`
                },
                {
                    title: 'ğŸŒŸ ×”×©×¤×¢×” ××¨×•×›×ª ×˜×•×•×—',
                    content: `×××•×¦×¢ ×©×œ ${avgImplementation}/5 ×‘××•×›× ×•×ª ×œ×™×™×©×•× ××” ×©× ×œ××“, ××” ×©××¢×™×“ ×¢×œ ×”×¢×¨×š ×”××¢×©×™ ×©×œ ×”×›× ×¡ ×•×¢×œ ×”×¤×•×˜× ×¦×™××œ ×œ×”×©×¤×¢×” ××¨×•×›×ª ×˜×•×•×—.`
                }
            ];

            insights.forEach(insight => {
                const card = document.createElement('div');
                card.className = 'insight-card';
                card.innerHTML = `
                    <h3 class="insight-title">${insight.title}</h3>
                    <div class="insight-content">${insight.content}</div>
                `;
                container.appendChild(card);
            });
        }

        function renderQuotes(stats) {
            const container = document.getElementById('quotes-section');
            container.innerHTML = '';

            // Featured quotes (best representative feedback)
            const featuredQuotes = [
                {
                    text: "×”×¡×“× ××•×ª ×”×ª××™××• ×‘××“×•×™×§ ×œ×¦×¨×›×™× ×©×–×•×”×• ××¨××©: ×‘×“×™×§×ª ××‘×—× ×™×, ×™×¦×™×¨×ª ×ª×•×›×Ÿ ×—×™× ×•×›×™, ×•×¤×™×ª×•×— ×›×œ×™× ×˜×›× ×•×œ×•×’×™×™×. ×× ×™ ×—×•×©×‘×ª ×©×”×™×” ×××“ ×—×©×•×‘ ×•×¤×¨×§×˜×™ ×•××¢×•×“×“ ×œ×”×ª×—×‘×¨ ×œ×›×œ×™× ×•×”×™×›×•×œ×•×ª ×œ×©×™×¤×•×¨ ×”×™×¢×™×œ×•×ª ×‘××•×¤×Ÿ ×™×•× ×™×•××™ ×•×¤×¨×§×˜×™",
                    author: "×©×•×œ×™ ××™×™×œ, ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ"
                },
                {
                    text: "×‘×××ª ×©×”×›×œ ××¤×©×¨×™ ×‘×¢×•×œ× ×©×œ× ×• ×›×™×•×. ×œ××¨×•×ª ×–××ª, ×–×• ×¨×§ ×”×”×ª×—×œ×” ×•×œ×›×Ÿ ×¤×™×ª×•×— ××•×¨×™×™× ×•×ª AI ×”×™× ××©×”×• ×©×¦×¨×™×š ×œ×”×©×§×™×¢ ×‘×• ×–××Ÿ ×¢\"× ×œ×”×‘×™×Ÿ ×›×™×¦×“ ×œ× ×¦×œ ××ª ×”×›×•×— ×”××“×™×¨ ×”×–×”. ×”×›× ×¡ ×‘×›×œ×œ×•×ª×• ×¢×•×¨×¨ ××—×©×‘×•×ª ×¢×œ ×ª×¤×§×™×“ ×”××•×¨×™× ×‘×¢×ª×™×“ ×•×‘×¤×¨×˜ ×œ×¤×™×–×™×§×”....××¡×§×¨×Ÿ!",
                    author: "××‘×™ ×’×¨×•×œ××Ÿ, ×¨×—×•×‘×•×ª"
                },
                {
                    text: "×œ××“×ª×™ ×œ×˜×™×™×‘ ××ª ×”×¢×‘×•×“×” ×¢× ×”×›×œ×™× ×•×¢×œ ×™×“×™ ×›×š ×œ×”×©×™×’ ×ª×•×¦××•×ª ×˜×•×‘×•×ª ×™×•×ª×¨ ×‘×¢×‘×•×“×ª×™ ×›××•×¨×”. ×§×™×‘×œ×ª×™ ×›××” ×¨×¢×™×•× ×•×ª ×•×× ×§×“×•×˜×•×ª ×œ××•×¤×Ÿ ×‘×™×¦×•×¢ ×œ×™××•×“ ×¢×¦××™ ×‘×¢×–×¨×ª AI",
                    author: "×™×•×‘×œ ×¡×’×œ, ×¨×—×•×‘×•×ª"
                },
                {
                    text: "××ª ×”×”×‘× ×” ×©××¤×©×¨ ×œ×¢×©×•×ª ×“×‘×¨×™× ××“×”×™××™× ×’× ×× ××ª×” ×œ× ××ª×›× ×ª. ×”×¡×“× ×” ×•×”×‘×¦×•×¢ ×©×œ ×“×¨×•×¨ ×¢×–×¨ ×œ× ×• ×œ×”×ª×—×™×œ ×•××©× ×›×‘×¨ ×”×™×™× ×• ×¢×¦×××™×™× ××¡×¤×™×§ ×œ×”×’×™×¢ ×œ×ª×•×¦××•×ª ×˜×•×‘×•×ª ×‘×–××Ÿ ×§×¦×¨",
                    author: "× ×™×¨ ×™×•× ×”, ×¨×—×•×‘×•×ª"
                }
            ];

            // Render featured quotes
            featuredQuotes.forEach(quote => {
                const quoteElement = document.createElement('div');
                quoteElement.className = 'quote';
                quoteElement.innerHTML = `
                    <div class="quote-text">${quote.text}</div>
                    <div class="quote-author">- ${quote.author}</div>
                `;
                container.appendChild(quoteElement);
            });

            // Add accordion for all feedback
            const accordionContainer = document.createElement('div');
            accordionContainer.className = 'accordion-container';
            accordionContainer.innerHTML = `
                <div class="accordion-header" onclick="toggleAccordion()">
                    <h3>ğŸ” ×”×¢×¨×•×ª × ×•×¡×¤×•×ª ××”××©×ª×ª×¤×™×</h3>
                    <span class="accordion-arrow">â–¼</span>
                </div>
                <div class="accordion-content" id="all-feedback">
                    <div class="feedback-categories">
                        <div class="feedback-category">
                            <h4>ğŸ’¡ ×¢×œ ×”×¡×“× ××•×ª</h4>
                            <div class="feedback-items" id="workshop-feedback"></div>
                        </div>
                        <div class="feedback-category">
                            <h4>ğŸ¤ ×¢×œ ×”×”×¨×¦××•×ª</h4>
                            <div class="feedback-items" id="lecture-feedback"></div>
                        </div>
                        <div class="feedback-category">
                            <h4>ğŸš€ ×”×¦×¢×•×ª ×œ×©×™×¤×•×¨</h4>
                            <div class="feedback-items" id="improvement-feedback"></div>
                        </div>
                        <div class="feedback-category">
                            <h4>ğŸ¯ ××©×•×‘ ×›×œ×œ×™</h4>
                            <div class="feedback-items" id="general-feedback"></div>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(accordionContainer);

            // Populate accordion with categorized feedback
            populateAccordionFeedback(stats);
        }

        function populateAccordionFeedback(stats) {
            const workshopFeedback = document.getElementById('workshop-feedback');
            const lectureFeedback = document.getElementById('lecture-feedback');
            const improvementFeedback = document.getElementById('improvement-feedback');
            const generalFeedback = document.getElementById('general-feedback');

            // Clear containers
            workshopFeedback.innerHTML = '';
            lectureFeedback.innerHTML = '';
            improvementFeedback.innerHTML = '';
            generalFeedback.innerHTML = '';

            // All feedback data from CSV
            const allFeedback = [
                {
                    category: 'workshop',
                    text: "×”×¡×“× ××•×ª ×¤×•× ×•×ª ×œ××’×•×•×Ÿ ×¨××•×ª. ×¢× ×–××ª, × ×™×ª×Ÿ ×œ×™×™×©×¨ ×§×• ×•×œ×”×¨××•×ª ××ª ×”×™×›×•×œ×•×ª\\×”×¤×•× ×§×¦×™×•×ª\\×”×¨×¢×™×•× ×•×ª ×‘×¢×–×¨×ª ×œ×¤×—×•×ª ×“×•×’××” ××—×ª ××•×›× ×” ××¨××©, ×•××©× ×©×”××ª×§×“××™× ×‘×ª×—×•× ×™×§×—×• ××ª ×–×” ×œ××Ÿ ×©××ª××™× ×œ×”×.",
                    author: "×•×“×™× ××•×–×¨×¡×§×™, ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ"
                },
                {
                    category: 'workshop',
                    text: "×‘×¢×™× ×™ ×”×™×” ×¦×•×¨×š ×‘×”×“×’××” ×™×•×ª×¨ \"××•×—×©×™×ª\" - ×¨×¦×£ ×©×œ ×¤×¨×•××¤×˜×™× ×•×ª×•×¦×¨×™× ×¢×“ ×œ×”×’×¢×” ×œ×ª×•×¦×¨ ××•×’××¨. ×‘× ×•×¡×£ ×“×¨×•×©×” ×™×•×ª×¨ ××©×¢×” ×©×œ ×¢×‘×•×“×” ×¢×¦××™×ª ×œ×©× ×”×’×¢×” ×œ×ª×•×¦×¨ ××•×’××¨.",
                    author: "×™×•×‘×œ ×¡×’×œ, ×¨×—×•×‘×•×ª"
                },
                {
                    category: 'lecture',
                    text: "×œ×”×‘×™×Ÿ ××” ××¤×©×¨ ×œ×¢×©×•×ª ×•××” ×”××’×‘×œ×•×ª. ××” ×”×ª×¤×§×™×“ ×©×œ× ×• ×›×©×™×© ×›×œ×™× ×©×™×›×•×œ×™× ×œ×¢×©×•×ª ×”×¨×‘×” ×××•×“.",
                    author: "×©× ×™ ××¤×™×§×™, ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ"
                },
                {
                    category: 'lecture',
                    text: "×œ×¨××•×ª ×‘×œ×™×™×‘ ××ª ×§×¦×‘ ×”××‘×•×œ×•×¦×™×” ×”×”×–×•×™ ×©×œ ×›×œ×™ ×”×”× ×¤×©×” ×•×”×•×•×™×“××• ×”×©×•× ×™×, ×•×œ×©××•×¢ ×“×•×’×××•×ª ××¢× ×™×™× ×•×ª ×¢×œ ×”×”×©×ª×¤×¨×•×ª ×©×œ ×”××•×“×œ×™× ×‘××™× ×˜×¨××§×¦×™×” ×¢× ×‘× ×™ ××“×",
                    author: "××‘×™ ×’×¨×•×œ××Ÿ, ×¨×—×•×‘×•×ª"
                },
                {
                    category: 'improvement',
                    text: "×”×¡×“× ××•×ª ×¦×¨×™×›×•×ª ×œ×”×™×•×ª ××•×¨×—×‘×•×ª ×™×•×ª×¨ ×œ×ª×¨×’×•×œ. ×× ××ª×¨×’×œ×™× ××ª ×”×©×™××•×©×™× ×”×©×•× ×™× ×¦×¨×™×š ×œ×ª×ª ×™×•×ª×¨ ×–××Ÿ ×œ×”×¢××§×ª ×”× ×•×©×.",
                    author: "×–××‘ ×–×™× ×™×•×§, ×—××“\"×¢"
                },
                {
                    category: 'improvement',
                    text: "×‘×›× ×¡ ×”×‘× ×”×™×™×ª×™ ××¢×“×™×£ ×”×¨×¦××” ××—×ª ×•×™×•×ª×¨ ×–××Ÿ ×œ×¡×“× ××•×ª ×¤×¨×§×˜×™×•×ª",
                    author: "××‘×™ ×’×¨×•×œ××Ÿ, ×¨×—×•×‘×•×ª"
                },
                {
                    category: 'improvement',
                    text: "×–××Ÿ ×œ×©××œ×•×ª ××—×¨×™ ×”×”×¨×¦××•×ª, ×¡×“× ××•×ª ×¢× ×ª×•×¦×¨×™× ×‘×¨×•×¨×™× ×™×•×ª×¨",
                    author: "×™×•× ×™×ª ×¡×’×œ, × ×’×‘ ××¢×¨×‘×™"
                },
                {
                    category: 'improvement',
                    text: "×”×™×™×ª×™ ×™×•×–× ×”×¤×¡×§×” ×§×¦×¨×” ×‘×™×Ÿ ×”×”×¨×¦××•×ª",
                    author: "× ×™×¨ ×™×•× ×”, ×¨×—×•×‘×•×ª"
                },
                {
                    category: 'general',
                    text: "×”×¢×¨×›×” ×¨×‘×” ×××“ ×œ×›×œ ×™×•×–××™ ×”×›× ×¡ ×•××‘×¦×¢×™×• ×¢×œ ×”×”×©×§×¢×” ×‘×”×›× ×ª×• , ×”×™×¨×™×“×” ×œ×¤×¨×˜×™× ×•×”××•×•×™×¨×” ×”××¦×•×™× ×ª. ×ª×¢× ×•×’!",
                    author: "××‘×™ ×’×¨×•×œ××Ÿ, ×¨×—×•×‘×•×ª"
                },
                {
                    category: 'general',
                    text: "×”×™×” ××•×¦×œ×— ×××•×“ ×‘×¢×™× ×™×™, × ×ª×Ÿ ×”×¨×‘×” ×¨×¢×™×•× ×•×ª ×œ×¤×¢×•×œ×” ×•×œ×™×™×©×•× ×¢×ª×™×“×™. ×›×“××™ ×©×™×”×™×” ×œ× ×• ×× ×•×™ ××¨×’×•× ×™ ×œ××•×“×œ×™× ×©×‘×”× ×™×© ×”×‘×“×œ ××©××¢×•×ª×™×ª ×‘×™×Ÿ ×”×’×¨×¡×” ×‘×ª×©×œ×•× ×œ×—×™× ××™×ª.",
                    author: "×™×•×œ×™×” ×‘×¨×•× ×©×˜×™×™×Ÿ, ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ"
                },
                {
                    category: 'general',
                    text: "×¦×¨×™×š ×œ×ª×¨×’×œ ×”×¨×‘×” ×›×“×™ ×œ×”×’×™×¢ ×œ×¨××” ×˜×•×‘×”. ×”×¡×“× ××•×ª ×¦×¨×™×›×•×ª ×œ×§×—×ª ×™×•×ª×¨ ×–××Ÿ ×ª×¨×’×•×œ.",
                    author: "×–××‘ ×–×™× ×™×•×§, ×—××“\"×¢"
                },
                {
                    category: 'general',
                    text: "× ×”× ×ª×™ ×××•×“ ×•××©××— ×œ×”×’×™×¢ ×œ×›× ×¡×™× ×“×•××™× ×‘×”××©×š!",
                    author: "×™×•× ×™×ª ×¡×’×œ, × ×’×‘ ××¢×¨×‘×™"
                }
            ];

            // Populate each category
            allFeedback.forEach(feedback => {
                const feedbackElement = document.createElement('div');
                feedbackElement.className = 'feedback-item';
                feedbackElement.innerHTML = `
                    <div class="feedback-text">${feedback.text}</div>
                    <div class="feedback-author">- ${feedback.author}</div>
                `;

                switch (feedback.category) {
                    case 'workshop':
                        workshopFeedback.appendChild(feedbackElement);
                        break;
                    case 'lecture':
                        lectureFeedback.appendChild(feedbackElement);
                        break;
                    case 'improvement':
                        improvementFeedback.appendChild(feedbackElement);
                        break;
                    case 'general':
                        generalFeedback.appendChild(feedbackElement);
                        break;
                }
            });
        }

        function toggleAccordion() {
            const accordion = document.getElementById('all-feedback');
            const arrow = document.querySelector('.accordion-arrow');
            
            if (accordion.style.display === 'none' || accordion.style.display === '') {
                accordion.style.display = 'block';
                arrow.textContent = 'â–²';
            } else {
                accordion.style.display = 'none';
                arrow.textContent = 'â–¼';
            }
        }

        function animateBars() {
            const barFills = document.querySelectorAll('.bar-fill');
            setTimeout(() => {
                barFills.forEach(bar => {
                    const value = bar.getAttribute('data-value');
                    bar.style.width = value + '%';
                });
            }, 500);
        }

        // Load and process data
        async function loadFeedbackData() {
            try {
                // Try to fetch the CSV file
                const response = await fetch('./assets/CSV/feedback_data.csv');

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const csvText = await response.text();

                if (!csvText || csvText.trim().length === 0) {
                    throw new Error('×§×•×‘×¥ CSV ×¨×™×§ ××• ×œ× ×ª×§×™×Ÿ');
                }

                const data = parseCSV(csvText);

                if (data.length === 0) {
                    throw new Error('×œ× × ××¦××• × ×ª×•× ×™× ×‘×§×•×‘×¥ CSV');
                }

                const stats = calculateStats(data);

                // Update last updated time
                document.getElementById('last-updated').textContent = new Date().toLocaleDateString('he-IL');

                // Render all components
                renderKeyStats(stats);
                renderWorkshopChart(stats);
                renderLectureChart(stats);
                renderGeographicChart(stats);
                renderExperienceChart(stats);
                renderInsights(stats);
                renderQuotes(stats);

                // Show content and hide loading
                document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';

                // Animate bars
                animateBars();

            } catch (error) {
                console.error('Error loading feedback data:', error);

                // Show detailed error message
                let errorMessage = '';
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    errorMessage = `
                        <h3>ğŸ”’ ×‘×¢×™×™×ª CORS - ×’×™×©×” ×œ×§×•×‘×¥ × ×—×¡××”</h3>
                        <p>×”×“×¤×“×¤×Ÿ ×—×•×¡× ×˜×¢×™× ×ª ×§×‘×¦×™× ××§×•××™×™× ××¡×™×‘×•×ª ××‘×˜×—×”.</p>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 20px 0; text-align: right;">
                            <h4>×¤×ª×¨×•× ×•×ª ××¤×©×¨×™×™×:</h4>
                            <ol style="text-align: right; margin: 10px 0;">
                                <li><strong>×”×¨×¥ ×©×¨×ª ××§×•××™:</strong><br/>
                                ×¤×ª×— terminal/cmd ×•× ×•×•×˜ ×œ×ª×™×§×™×™×ª ×”×¤×¨×•×™×§×˜ ×•×¨×•×¥:<br/>
                                <code style="background: rgba(0,0,0,0.3); padding: 5px; border-radius: 3px;">python -m http.server 8000</code><br/>
                                ×•××– ×¤×ª×—: <a href="http://localhost:8000" target="_blank">http://localhost:8000</a>
                                </li>
                                <li><strong>×”×©×ª××© ×‘-VSCode Live Server:</strong><br/>
                                ×”×ª×§×Ÿ ××ª ×”×”×¨×—×‘×” "Live Server" ×•×œ×—×¥ ×¢×œ×™×”</li>
                                <li><strong>×¤×ª×— ×¢× --disable-web-security:</strong><br/>
                                ×¤×ª×— ××ª ×”×“×¤×“×¤×Ÿ ×¢× ×”×¤×¨××˜×¨ ×”×–×” (×œ× ××•××œ×¥)</li>
                            </ol>
                        </div>
                        <p><strong>×§×•×‘×¥ ×”× ×ª×•× ×™× × ××¦× ×‘:</strong> assets/CSV/feedback_data.csv</p>
                    `;
                } else {
                    errorMessage = `
                        <h3>âŒ ×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×</h3>
                        <p><strong>×¤×¨×˜×™ ×”×©×’×™××”:</strong> ${error.message}</p>
                        <p>×× × ×‘×“×§ ××ª ×”×§×•×‘×¥ assets/CSV/feedback_data.csv</p>
                    `;
                }

                document.getElementById('loading').innerHTML = errorMessage;
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', loadFeedbackData);

        // Add hover effects
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.stat-card, .insight-card, .quote').forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-5px)';
                    this.style.transition = 'all 0.3s ease';
                });

                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>
</body>

</html>